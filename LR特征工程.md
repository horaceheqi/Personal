di# 特征工程步骤
### 1、数据质量检验
#### 1、1 检查总量
按提数需求，检查固定时间间隔内数据量大小是否有波动，如果波动过大，不适合用该时间段内数据构建模型

比如：提取8月1号到8月30号的数据

||日期|量|
|----|----|----|
|1|08-01|1亿|
|2|08-02|1.07亿|
|...|...|...|
|7|08-07|0.97亿|

根据实际情况，可以按月、按天、按小时等进行划分，主要是看数据是否有波动
#### 1、2 检查变量
主要是检查现有变量的饱和程度和部分部分变量之间是否统计正确；如果，字段数据缺失比较严重，则可以舍弃该字段变量；某些字段是其他字段的总和，看累加是否一致。

### 2、提取现有变量

### 3、变量衍生
直接从现有变量衍生的变量我们称之为一级变量，由一级变量衍生的变量称之为二级变量，由二级变量衍生的变量称之为三级变量，以此类推...

例如：原始数据

|时间|用户|月收入|
|------|------|------|
|2018-08|01|5000|
|2018-07|01|4560|
|2018-06|01|5120|
|2018-05|01|5000|
|2018-04|01|4960|
|2018-03|01|5120|
|2018-02|01|5120|
|2018-01|01|4960|
|2017-12|01|5000|
|2017-11|01|5120|
|2017-10|01|5120|
|2017-09|01|5120|

衍生：一级变量

|衍生变量含义(一级变量)|用户|数值|计算方式|
|----------|----------|----------|----------|
|近1个月最大月收入|01|5000|MAX|
|近3个月最大月收入|01|5120|MAX|
|近6个月最大月收入|01|5120|MAX|
|近9个月最大月收入|01|5120|MAX|
|近12个月最大月收入|01|5120|MAX|

衍生：二级变量

|衍生变量含义(二级变量)|用户|数值|计算方式|
|----------|----------|----------|----------|
|相邻间隔最大工资波动|01|0.977|近1个月/近3个月|
|相邻间隔最大工资波动|01|1.000|近3个月/近6个月|
|相邻间隔最大工资波动|01|1.000|近6个月/近9个月|
|相邻间隔最大工资波动|01|1.000|近9个月/近12个月|

......

### 4、聚类
衍生后的变量其数量较多、相关性比较大，并且有些变量对模型的效果并没有影响，因此我们要对衍生后的变量进行聚类，通过K-means、DBSCAN等算法对衍生后的变量进行聚类生成变量池，为后续的变量无纲化和筛选做准备。

### 5、变量筛选
之前的所有过程都是单纯对特征进行操作，在筛选阶段，我们加入各个变量所对应的Label(即Y值)，对每个变量进行无纲化操作(即分箱、离散化操作)，主要是计算每个变量的WOE数值

#### 5、1 WOE计算方法
|地区|label_0|label_1|rate_0|rate_1|WOE|
|------|------|------|------|------|------|
|北京|823521|179982|0.6434|0.6191|-0.0384|
|天津|456371|110724|0.3566|0.3809|0.0659|


#### 5.2、筛选变量
对所有的变量进行离散化并计算其WOE值，接下来对这些变量再进行聚类，相同类选取WOE值较好的特征作为训练模型的数据

#### 6、训练模型
用筛选后的数据进行模型的训练

#### 7、模型估计
各种模型估计权值：准确率、召回率、F1值、ROC曲线、AUC曲线、KS值、R^2值、MSE 等等


